# 【16】資安的原罪 ch.3-2.c 中間人攻擊

"Imagine logging into your online banking app, carefully entering your username and password, and then thinking you’re securely accessing your account. But unbeknownst to you, a hacker is silently intercepting your credentials, watching your every move, and even altering the transaction details. This is the danger of a Man-in-the-Middle (MITM) Attack — one of the most insidious threats in today’s cybersecurity landscape."

---


### **2. Definition: What is a Man-in-the-Middle Attack?**

A **Man-in-the-Middle (MITM)** attack occurs when a cybercriminal secretly intercepts and potentially alters the communication between two parties who believe they are directly communicating with each other. The attacker is "in the middle" of the data flow, often without either side realizing it, giving them the ability to eavesdrop, steal information, inject malicious data, or impersonate one of the parties.

* **Adversary in the Middle (AIM)** is sometimes used interchangeably, highlighting the role of the attacker as the malicious entity.


### **So, Can ISPs, VPN Providers, or Network Admins Be Considered MITM?**

Yes, they **technically** could be considered **Man-in-the-Middle** in certain scenarios:

* **ISP**: Can intercept unencrypted traffic, monitor, or even modify the content. This could raise concerns if the ISP does this without your knowledge or consent.
* **VPN Providers**: If the VPN provider has access to your encrypted data or logs, they might be seen as a **trusted MITM** — essentially decrypting and reading your traffic. It’s important to **trust your VPN provider** and make sure they don’t compromise your privacy.
* **Network Administrators (Schools/Corporations)**: While they may have legitimate reasons to monitor and inspect traffic for security or policy enforcement, they are **in the middle** of the communication and could, in theory, eavesdrop or manipulate data without the user’s knowledge.

* **ISPs, VPNs, and network administrators** can perform actions that resemble MITM attacks, depending on their level of control over network traffic, but they do so for **legitimate reasons** in most cases.
---


### **3. Example: Real-World Scenario**

**Scenario: Public Wi-Fi Attack**

Sarah is sitting in a café, connected to the coffee shop's free Wi-Fi, checking her email and making a few online purchases. What she doesn't know is that a hacker, sitting nearby, has set up a fake Wi-Fi hotspot that mimics the café’s real network. When Sarah connects to the "Free\_CoffeeShop\_WiFi," the attacker intercepts and monitors all of her internet traffic, including sensitive login credentials and credit card information.

In this MITM attack, the attacker not only listens in on Sarah’s communications but could also modify transaction details, redirect her to fake websites, or steal her identity.

TODO: REAL EXAMPLE
B292 New york times
## DNS
「Hazy Hawk」利用DNS錯誤配置劫持知名機構網域[^1]


“HTTPS can be stripped” — also accurate in the sense of SSL/TLS stripping attacks or misconfigurations that downgrade or bypass protections. Explain the concept and show how defenses (HSTS, modern TLS, certificate validation) stop it. Avoid step‑by‑step attack instructions.
---

### **4. Techniques: How Do MITM Attacks Work?**

Here are several common techniques used in MITM attacks:

* **ARP Spoofing (Address Resolution Protocol Spoofing)**:

  * The attacker sends false ARP messages within a local network, associating their own MAC address with the victim's IP address. As a result, the attacker can intercept traffic intended for the victim.

* **SSL Stripping**:

  * An attacker downgrades an HTTPS (secure) connection to HTTP (insecure), stripping away the encryption. This allows them to read, modify, or inject malicious content into the communication.

* **Rogue DHCP Server Attack**: The attacker sets up a fake DHCP server and assigns malicious network settings (e.g., fake gateway or DNS), positioning themselves in the middle of the victim’s traffic.

* **DNS Spoofing/Cache Poisoning**:

  * The attacker poisons a DNS server's cache with incorrect DNS records, leading the victim to a fraudulent website, where they can steal sensitive data like login credentials or install malware.

* **Wi-Fi Eavesdropping (Evil Twin Attacks)**:

  * The attacker creates a rogue Wi-Fi access point that appears identical to a legitimate network. When victims connect, all their internet traffic passes through the attacker’s system, allowing them to intercept and modify data.

* **Session Hijacking**:

  * In this case, the attacker steals a valid session cookie, allowing them to impersonate the victim without needing to know their password. This is often done through MITM to intercept session tokens while the victim is logged in.

There are several examples of malware targeting cookies from web browsers on the local system. Adversaries may also steal cookies by injecting malicious JavaScript content into websites or relying on User Execution by tricking victims into running malicious JavaScript in their browser.

There are also open source frameworks such as Evilginx2 and Muraena that can gather session cookies through a malicious proxy (e.g., Adversary-in-the-Middle) that can be set up by an adversary and used in phishing campaigns.

After an adversary acquires a valid cookie, they can then perform a Web Session Cookie technique to login to the corresponding web application.[^2]
---


### **5. Impacts: What Are the Consequences?**

The consequences of MITM attacks can be severe for both individuals and organizations:

* **Data Theft**:

  * Sensitive personal or financial information (e.g., usernames, passwords, credit card details) can be stolen and used for malicious purposes such as identity theft, fraud, or account takeovers.

* **Loss of Data Integrity**:

  * Attackers may alter the communication in transit. For example, a bank transfer could be modified to redirect funds to the attacker’s account, or malicious code could be inserted into otherwise legitimate files.

* **Impersonation**:

  * The attacker can impersonate either of the communicating parties. This can lead to unauthorized access to systems, malicious transactions, or spreading misinformation.

* **Undermining Trust**:

  * MITM attacks erode trust in online communications. If users begin to suspect that their communication is being intercepted, they may avoid using certain services or sharing sensitive information, which can hurt businesses and disrupt online services.
  
* **Silent traffic redirection**: Victims may unknowingly connect through the attacker’s gateway or use malicious DNS servers, enabling phishing, session hijacking, or malware injection.

* **Reputational Damage**:

  * If an organization is compromised by a MITM attack, the resulting data breach or financial loss can severely damage its reputation, especially if customers' sensitive information is involved.

---


### **Summary: Why Is This Important?**

MITM attacks are a serious security threat because they are difficult to detect and can have wide-ranging consequences. By understanding how these attacks work and recognizing the potential impacts, individuals and organizations can take necessary precautions to protect themselves, such as using encryption, securing network connections, and implementing additional layers of security like multi-factor authentication.


---





[^1]: https://www.informationsecurity.com.tw/article/article_detail.aspx?aid=11907
[^2]: https://attack.mitre.org/techniques/T1539/