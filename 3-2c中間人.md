# ã€16ã€‘è³‡å®‰çš„åŸç½ª ch.3-2.c ä¸­é–“äººæ”»æ“Š

ã€Œæƒ³åƒä¸€ä¸‹ï¼Œä½ æ­£åœ¨ç™»å…¥ç¶²è·¯éŠ€è¡Œæ‡‰ç”¨ç¨‹å¼ï¼Œä»”ç´°è¼¸å…¥ä½¿ç”¨è€…åç¨±å’Œå¯†ç¢¼ï¼Œä¸¦ä»¥ç‚ºè‡ªå·±æ­£åœ¨å®‰å…¨åœ°å­˜å–å¸³æˆ¶ã€‚ä½†ä½ ä¸çŸ¥é“çš„æ˜¯ï¼Œæœ‰ä¸€å€‹é§­å®¢æ­£æ‚„æ‚„æ””æˆªä½ çš„èªè­‰è³‡è¨Šï¼Œç›£è¦–ä½ çš„ä¸€èˆ‰ä¸€å‹•ï¼Œç”šè‡³æ›´æ”¹äº¤æ˜“ç´°ç¯€ã€‚é€™å°±æ˜¯ä¸­é–“äººæ”»æ“Šï¼ˆMan-in-the-Middleï¼ŒMITMï¼‰çš„å±éšªâ€”â€”ç•¶ä»Šè³‡å®‰ç’°å¢ƒä¸­æœ€éš±è”½ä¸”å±å®³å·¨å¤§çš„å¨è„…ä¹‹ä¸€ã€‚ã€

---

### **ä»€éº¼æ˜¯ä¸­é–“äººæ”»æ“Šï¼Ÿ**

ä¸­é–“äººæ”»æ“Šï¼ˆMan-in-the-Middleï¼ŒMITMï¼‰ï¼Œæœ‰æ™‚ä¹Ÿç¨±ç‚º **ä¸­é–“æ•µæ‰‹æ”»æ“Šï¼ˆAdversary in the Middleï¼ŒAITMï¼‰ æ˜¯æŒ‡**æ”»æ“Šè€…ä½æ–¼è³‡æ–™æµçš„ã€Œä¸­é–“ã€**ï¼Œé€šå¸¸é›™æ–¹éƒ½ä¸æœƒå¯Ÿè¦ºï¼Œä½¿æ”»æ“Šè€…èƒ½å¤ ç«Šè½ã€ç«Šå–è³‡è¨Šã€æ³¨å…¥æƒ¡æ„è³‡æ–™ï¼Œæˆ–å†’å……å…¶ä¸­ä¸€æ–¹ã€‚

### **åˆæ³•ä¸­é–“äºº**

* **ç¶²éš›ç¶²è·¯æœå‹™æä¾›å•†ï¼ˆISPï¼‰**ï¼šèƒ½å¤ æ””æˆªæœªåŠ å¯†çš„æµé‡ã€é€²è¡Œç›£æ§ï¼Œç”šè‡³ä¿®æ”¹å…§å®¹ã€‚å¦‚æœåœ¨æœªç¶“ä½ çŸ¥æƒ…æˆ–åŒæ„çš„æƒ…æ³ä¸‹é€™éº¼åšï¼Œå¯èƒ½æœƒå¼•ç™¼éš±ç§ç–‘æ…®ã€‚

* **VPN æ¥­è€…**ï¼šè‹¥ VPN æœå‹™å•†èƒ½å­˜å–ä½ çš„åŠ å¯†è³‡æ–™æˆ–ç´€éŒ„æ—¥èªŒï¼Œä»–å€‘å°±å¯èƒ½è¢«è¦–ç‚ºä¸€ç¨®**å—ä¿¡ä»»çš„ä¸­é–“äºº**â€”â€”ä¹Ÿå°±æ˜¯ä»–å€‘èƒ½è§£å¯†ä¸¦æŸ¥çœ‹ä½ çš„æµé‡ã€‚å› æ­¤ï¼Œé¸æ“‡å¯ä¿¡è³´çš„ VPN ä¾›æ‡‰å•†éå¸¸é‡è¦ï¼Œä»¥é¿å…éš±ç§å—åˆ°ä¾µçŠ¯ã€‚

* **ç¶²è·¯ç®¡ç†å“¡ï¼ˆä¾‹å¦‚å­¸æ ¡æˆ–å…¬å¸ï¼‰**ï¼šå„˜ç®¡ä»–å€‘å¯èƒ½å‡ºæ–¼å®‰å…¨æˆ–æ”¿ç­–åŸ·è¡Œçš„æ­£ç•¶ç†ç”±ç›£æ§èˆ‡æª¢æŸ¥æµé‡ï¼Œä½†ä»–å€‘å¯¦éš›ä¸Šä¹Ÿè™•æ–¼**é€šè¨Šéç¨‹çš„ä¸­é–“ä½ç½®**ï¼Œç†è«–ä¸Šå¯ä»¥åœ¨ä½¿ç”¨è€…ä¸çŸ¥æƒ…çš„æƒ…æ³ä¸‹é€²è¡Œç›£è½æˆ–è³‡æ–™æ“ä½œã€‚

---

### **4. æŠ€è¡“æ‰‹æ³•ï¼šä¸­é–“äººæ”»æ“Šæ˜¯å¦‚ä½•é‹ä½œçš„ï¼Ÿ**

* **ARP æ¬ºé¨™ï¼ˆARP Spoofing / Address Resolution Protocol Spoofingï¼‰**

  * æ”»æ“Šè€…åœ¨å€åŸŸç¶²è·¯ä¸­ç™¼é€å½é€ çš„ ARP å°åŒ…ï¼Œå°‡è‡ªå·±çš„**MAC ä½å€**ç¶å®šåˆ°å—å®³è€…çš„ IP ä½å€ã€‚é€™æ¨£ä¸€ä¾†ï¼ŒåŸæœ¬ç™¼çµ¦å—å®³è€…çš„è³‡æ–™å°±æœƒè¢«è½‰é€åˆ°æ”»æ“Šè€…æ‰‹ä¸­ï¼Œé€²è€Œå¯¦ç¾æ””æˆªã€‚

* **å½é€  DHCP ä¼ºæœå™¨æ”»æ“Šï¼ˆRogue DHCP Server Attackï¼‰**

  * æ”»æ“Šè€…æ¶è¨­ä¸€å€‹**å‡çš„ DHCP ä¼ºæœå™¨**ï¼Œä¸¦ç™¼é€æƒ¡æ„ç¶²è·¯è¨­å®šï¼ˆä¾‹å¦‚å½é€ çš„é–˜é“å™¨æˆ– DNS ä¼ºæœå™¨ï¼‰ï¼Œè—‰æ­¤å°‡å—å®³è€…çš„æµé‡å¼•å°åˆ°è‡ªå·±èº«ä¸Šï¼Œé”åˆ°ä¸­é–“äººä½ç½®ã€‚

* **DNS æ¬ºé¨™ / å¿«å–æ±¡æŸ“ï¼ˆDNS Spoofing / Cache Poisoningï¼‰**

  * æ”»æ“Šè€…**æ±¡æŸ“ DNS å¿«å–è³‡æ–™ï¼Œæ¤å…¥éŒ¯èª¤çš„ DNS ç´€éŒ„**ï¼Œä½¿å—å®³è€…è¢«å°å‘å‡çš„ç¶²ç«™ã€‚æ”»æ“Šè€…å¯è—‰æ­¤ç«Šå–ç™»å…¥æ†‘è­‰æˆ–æ¤å…¥æƒ¡æ„ç¨‹å¼ã€‚

* **Wi-Fi ç«Šè½ / é‚ªæƒ¡é›™èƒèƒæ”»æ“Šï¼ˆEvil Twin Attackï¼‰**

  * æ”»æ“Šè€…å»ºç«‹ä¸€å€‹å½é€ çš„ Wi-Fi ç†±é»ï¼Œ**åç¨±èˆ‡å¤–è§€èˆ‡åˆæ³•ç¶²è·¯å¹¾ä¹ç›¸åŒ**ã€‚ä¸€æ—¦å—å®³è€…é€£æ¥ä¸Šé€™å€‹å‡ç†±é»ï¼Œä»–å€‘çš„æ‰€æœ‰ç¶²è·¯æµé‡å°±æœƒè¢«æ”»æ“Šè€…æ””æˆªã€æŸ¥çœ‹ï¼Œç”šè‡³ä¿®æ”¹ã€‚

* **SSL é™ç´šæ”»æ“Šï¼ˆSSL Strippingï¼‰**

  * æ”»æ“Šè€…å°‡åŸæœ¬å®‰å…¨çš„ HTTPS é€£ç·šé™ç´šç‚ºä¸å®‰å…¨çš„ HTTPï¼Œè—‰æ­¤ç§»é™¤åŠ å¯†ä¿è­·ã€‚é€™è®“æ”»æ“Šè€…å¯ä»¥æŸ¥çœ‹ã€ä¿®æ”¹æˆ–æ’å…¥æƒ¡æ„å…§å®¹é€²å…¥é€šè¨Šä¸­ã€‚

* **æœƒè©±åŠ«æŒï¼ˆSession Hijackingï¼‰**

  * æ”»æ“Šè€…ç«Šå–åˆæ³•çš„æœƒè©± Cookieï¼Œé€²è€Œå†’å……å—å®³è€…ç™»å…¥ç³»çµ±ï¼Œè€Œç„¡éœ€çŸ¥é“å¯†ç¢¼ã€‚é€™é€šå¸¸é€é MITM æ”»æ“Šä¾†æ””æˆªå—å®³è€…ç™»å…¥æ™‚å‚³é€çš„æœƒè©±æ†‘è­‰ã€‚


TODO: REAL EXAMPLE
B292 New york times
## DNS
ã€ŒHazy Hawkã€åˆ©ç”¨DNSéŒ¯èª¤é…ç½®åŠ«æŒçŸ¥åæ©Ÿæ§‹ç¶²åŸŸ[^1]

â€œHTTPS can be strippedâ€ â€” also accurate in the sense of SSL/TLS stripping attacks or misconfigurations that downgrade or bypass protections. Explain the concept and show how defenses (HSTS, modern TLS, certificate validation) stop it. Avoid stepâ€‘byâ€‘step attack instructions.

---

### ç€è¦½å™¨ä¸­é–“äººæ”»æ“Šï¼ˆMITBï¼ŒMan-in-the-Browserï¼‰

**1. Definition & Core Idea**

MITB æ”»æ“Šæ˜¯æŒ‡æ”»æ“Šè€…é€éæƒ¡æ„è»Ÿé«”æˆ–ç€è¦½å™¨å¤–æ›ï¼Œåœ¨ä½¿ç”¨è€…æœ¬åœ°ç«¯çš„ç€è¦½å™¨ä¸­æ³¨å…¥æƒ¡æ„ç¨‹å¼ç¢¼ï¼Œé€šå¸¸åœ¨è³‡æ–™è¢«**åŠ å¯†æˆ–é€å‡ºä¹‹å‰å°±ä¸‹æ‰‹**ï¼Œå³ä½¿æ˜¯ä½¿ç”¨ HTTPS ä¹Ÿå¯èƒ½è¢«æ”»æ“Šã€‚å°ä½¿ç”¨è€…èˆ‡ç¶²é æ‡‰ç”¨ç¨‹å¼ä¾†èªªï¼Œé€™ç¨®æ”»æ“Šå¹¾ä¹**ç„¡æ³•å¯Ÿè¦º**ã€‚

* Banking trojans (e.g., Zeus, SpyEye, Dyre)
* Zeus (2007â€“2015): Intercepted bank logins, injected extra fields.
* Dridex, Emotet: Delivered via email, hijacked browsers to steal financial info.
* RedLine stealer, modern crypto wallet stealers: Grabbing session tokens.

> MITMï¼ˆä¸­é–“äººæ”»æ“Šï¼‰ä¸»è¦é‡å°**ä½¿ç”¨è€…èˆ‡ä¼ºæœå™¨ä¹‹é–“çš„ç¶²è·¯é€šè¨Š**ï¼Œæ”»æ“Šè€…æœƒæ””æˆªæˆ–ç«„æ”¹å‚³è¼¸ä¸­çš„è³‡æ–™ï¼Œå°ç¶²è·¯å±¤é€ æˆå¨è„…ï¼›è€ŒMITBï¼ˆç€è¦½å™¨ä¸­é–“äººæ”»æ“Šï¼‰å‰‡ç›´æ¥**å…¥ä¾µä½¿ç”¨è€…çš„ç€è¦½å™¨ç’°å¢ƒ**ï¼Œç¹éç¶²è·¯å±¤çš„å®‰å…¨é˜²è­·ï¼Œå°ä½¿ç”¨è€…ç«¯é€ æˆæ›´æ·±å…¥ä¸”é›£ä»¥å¯Ÿè¦ºçš„å¨è„…ã€‚


### å¸¸è¦‹å¯¦ä½œæ‰‹æ³•ï¼ˆæ¦‚å¿µæ€§ï¼Œä¸æä¾›æ”»æ“Šç´°ç¯€ï¼‰
 æƒ¡æ„ç¨‹å¼æœƒä»¥èƒ½å¤ è®€å–æˆ–ä¿®æ”¹ç€è¦½å™¨å…§å®¹çš„æ–¹å¼é‹ä½œ
ä¾‹å¦‚ï¼šæ³¨å…¥ç¨‹å¼ç¢¼åˆ°ç€è¦½å™¨é€²ç¨‹ã€æ›é‰¤ç€è¦½å™¨ APIã€æˆ–ä½œç‚ºæƒ¡æ„å¤–æ›é‹è¡Œã€‚
* TODO: 
* DLL injection (on Windows)
* Browser memory tampering
* æƒ¡æ„ç€è¦½å™¨å¤–æ› / æ“´å……åŠŸèƒ½ï¼šä»¥åˆæ³•å¤–æ›èº«ä»½å®‰è£ä½†å…§å«æƒ¡æ„é‚è¼¯ã€‚
* æ³¨å…¥ JavaScript åˆ°é é¢ï¼ˆæˆ–åœ¨ DOM å±¤æ›é‰¤ï¼‰ï¼šå‹•æ…‹ä¿®æ”¹è¡¨å–®æˆ–ä¸­æ–·æäº¤æµç¨‹ã€‚ TODO: DOM injection, JavaScript modification
* åœ¨ä½œæ¥­ç³»çµ±å±¤é¢æ³¨å…¥/æ›é‰¤ç€è¦½å™¨ç¨‹åºï¼ˆä¾‹å¦‚é€éæƒ¡æ„ç¨‹å¼ç¢¼æ¨¡çµ„ï¼‰ä»¥ç›£æ§èˆ‡æ””æˆªæµé‡ã€‚
* ä½¿ç”¨ã€ŒWebInjectã€é¡å‹æŠ€è¡“ï¼šæ ¹æ“šç›®æ¨™ç¶²ç«™è‡ªå‹•åŒ¹é…ä¸¦æ”¹å¯«è¼¸å…¥/æäº¤è³‡æ–™ã€‚

**MITB vs. MITM: Key Differences**

| Feature            | MITM                                         | MITB                               |
| ------------------ | -------------------------------------------- | ---------------------------------- |
| Target             | Network communication                        | Browser process                    |
| Location           | External (on network)                        | Internal (on infected device)      |
| Requires access to | Network or router                            | Browser or OS                      |
| Visibility to user | Rare, sometimes visible (e.g. cert warnings) | Completely invisible               |
| Bypasses HTTPS     | No                                           | Yes                                |

---


TODO:  SNARF?
## ç«Šè½
é™¤äº†ï¼Œä¹Ÿæœ‰ç•¶ç´”ç«Šè½çš„

### 2. ç«Šè½ï¼ˆEavesdroppingï¼‰åœ¨MITMä¸­çš„è§’è‰²

* ç«Šè½æ˜¯è¢«å‹•æ””æˆªè¨Šæ¯çš„è¡Œç‚ºï¼Œæ˜¯MITMçš„åŸºç¤æˆ–ç¬¬ä¸€æ­¥
* ç«Šè½å¾Œï¼Œæ”»æ“Šè€…å¯èƒ½é€²ä¸€æ­¥ç¯¡æ”¹æˆ–å½é€ è¨Šæ¯ï¼Œå®ŒæˆMITM

### 3. å…¸å‹çš„ç«Šè½å ´æ™¯

* **WiFi**

  * å…¬å…±ç†±é»æ˜“é­å‡ç†±é»ã€ARP spoofingæ”»æ“Š
  * æ”»æ“Šè€…å¯åœ¨ç„¡åŠ å¯†æˆ–å¼±åŠ å¯†ç’°å¢ƒä¸­ç«Šè½
* **Bluetooth**

  * é…å°éç¨‹ä¸­è‹¥ç¼ºä¹å¼·èªè­‰ï¼Œæ˜“è¢«ç«Šè½æˆ–ä¸­é–“äººæ”»æ“Š
  * æ”»æ“Šä¾‹å­ï¼šKNOBæ”»æ“Šã€BlueBorne
* å…¶ä»–ï¼šæœ‰ç·šç¶²è·¯ã€æ‰‹æ©ŸçŸ­ä¿¡ï¼ˆSMSï¼‰ç­‰

### 4. MITMæ”»æ“Šçš„é¢¨éšª

* æ•æ„Ÿè³‡æ–™å¤–æ´©ï¼ˆå¯†ç¢¼ã€ä¿¡ç”¨å¡è™Ÿï¼‰
* èº«ä»½ç›œç”¨èˆ‡å½é€ 
* æœƒè©±åŠ«æŒèˆ‡æ§åˆ¶æ¬Šå¥ªå–

### 5. é˜²ç¯„æªæ–½

* **åŠ å¯†é€šè¨Š**ï¼ˆHTTPS/TLSã€BluetoothåŠ å¯†ï¼‰
* **èº«ä»½èªè­‰**ï¼ˆé¿å…å‡ç†±é»ã€è¨­å‚™é©—è­‰ï¼‰
* **ä½¿ç”¨å®‰å…¨ç¶²è·¯ç’°å¢ƒ**ï¼ˆé¿å…ä½¿ç”¨å…¬å…±æœªåŠ å¯†WiFiï¼‰
* **æ›´æ–°éŸŒé«”èˆ‡è»Ÿé«”**ï¼ˆé˜²æ­¢å·²çŸ¥æ¼æ´è¢«åˆ©ç”¨ï¼‰

### 6. ç¸½çµ

* MITMæ˜¯å¤šå±¤æ¬¡çš„æ”»æ“Šï¼Œç«Šè½æ˜¯å…¶é‡è¦ç’°ç¯€
* **ç„¡ç·šé€šè¨Šç’°å¢ƒï¼ˆWiFiã€Bluetoothï¼‰ç‰¹åˆ¥å®¹æ˜“å—å½±éŸ¿**

#### ğŸ”¹ **Bluetooth MITM (e.g., during pairing)**:

* Vulnerable during **initial pairing** if security is weak (e.g., no authentication or static PINs).
* Attackers can **impersonate** a trusted device or intercept data (like in a keyboard or headphone connection).
* Known attacks:

  * **KNOB attack** (Key Negotiation of Bluetooth): Downgrades encryption strength.
  * **BlueBorne**, **BtleJack**, etc.

#### ğŸ”¹ **SMS MITM**:

* SMS is often used for **2FA** (two-factor authentication), and attackers can:

  * Exploit **SS7 protocol vulnerabilities** (used by telecom networks) to intercept SMS.
  TODO:
  * Use **SIM swapping** or **number porting** to reroute SMS to themselves.
* MITM in SMS can allow attackers to hijack accounts that rely on SMS verification.

TODO:
There are several examples of malware targeting cookies from web browsers on the local system. Adversaries may also steal cookies by injecting malicious JavaScript content into websites or relying on User Execution by tricking victims into running malicious JavaScript in their browser.

There are also open source frameworks such as Evilginx2 and Muraena that can gather session cookies through a malicious proxy (e.g., Adversary-in-the-Middle) that can be set up by an adversary and used in phishing campaigns.

After an adversary acquires a valid cookie, they can then perform a Web Session Cookie technique to login to the corresponding web application.[^2]



---

## åŸç½ª

## é›£ç™¼ç¾
MITM attacks are a serious security threat because they are difficult to detect and can have wide-ranging consequence


## Signs of MITM (unexpected certificate warnings, slow connection, unusual network behavior)

Monitoring tools and network anomaly detection

### æ‰‹ä¸éœ€è¦ä¼¸é€²è£ç½®
ä¸ç•™ç—•è·¡

### ç„¡æ³•


* No visible changes to network traffic.
* Antivirus often fails to detect polymorphic malware.
* Legitimate-looking browser behavior (unless you inspect DOM or form data)

### Why a â€œquietâ€ MITM is hard to detect

If the attacker only passively sniffed traffic (e.g., captured packets on an unencrypted Wiâ€‘Fi) and didnâ€™t alter messages, there may be no visible protocol anomalies. Encrypted sessions (TLS) protect content, so passive capture leaves little footprint on the network beyond the capture itself.

If the attacker intercepts and relays (transparent MITM) but preserves TLS correctly (e.g., compromises a client or a CA, or performs a proxy with valid certs on the client), traffic looks normal to endpoints.

Short-lived or low-volume MITMs may not show up in logs, and many default logging levels donâ€™t capture the small anomalies an attacker relies on.


[^1]: https://www.informationsecurity.com.tw/article/article_detail.aspx?aid=11907
[^2]: https://attack.mitre.org/techniques/T1539/