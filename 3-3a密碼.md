# 【19】資安的原罪 ch.3-3.a 密碼與身分驗證

### 1. **Introduction**

* What is authentication?
* Importance of authentication in cybersecurity
* Difference between authentication and authorization
* Real-world examples (e.g., logging into an email account)

### 2. **Types of Authentication**
## biometrics

圖像密碼
兩階段身分驗證
生物辨識技術 臉部辨識 指紋掃描
指紋 臉部特徵 視網膜掃描

* **Something You Know**

  * Passwords, PINs
* **Something You Have**

  * Smart cards, OTP tokens, security keys
* **Something You Are**

  * Biometrics (fingerprint, face recognition)
* **Somewhere You Are / Behavioral Biometrics**

  * IP-based/location-based authentication

### 4. **Modern Alternatives and Enhancements**

* **Two-Factor Authentication (2FA)**

  * SMS codes, authenticator apps, hardware tokens
* **Multi-Factor Authentication (MFA)**

  * Combining 2+ factors for stronger security
* **Single Sign-On (SSO)**

  * Logging in once for access to multiple services
* **Passwordless Authentication**

  * Biometrics, magic links, device-based authentication


## MFA
多重要素驗證 multi-factor authentication, mfa

## PassWord
美國國防部綠皮書 密碼該由機器利用演算法生成 [^連結](https://apps.dtic.mil/sti/citations/ADA425705)
密碼管理工具

# Hashing
密碼存雜湊
Hashing is a process that transforms data, like a password, into a fixed-length string of characters using a special algorithm. This transformation is one-way, meaning it’s easy to create the hash from the original data but nearly impossible to reverse it back. Hashing helps keep passwords secure by storing only the hashed version, so even if someone accesses the data, they can’t see the actual passwords.

#### 1. **What is a Hash Function?**

* A one-way cryptographic function that turns input (e.g., a password) into a fixed-length string.
* Deterministic: same input → same output.
* Non-reversible: you can't retrieve the original input from the hash.

#### 2. **Why Use Hashes in Password Storage?**

* Prevent storing plain-text passwords.
* Even if the database is leaked, attackers don’t get actual passwords—only hashes.

#### 4. **Salting**

* Adding a unique, random value to each password before hashing.
* Prevents attackers from using precomputed hash tables (rainbow tables).
* Ensures that identical passwords result in different hashes.

TODO:
#### 5. **Peppering (Optional for Advanced Audience)**

* A secret key added before or after hashing.
* Stored separately from the database (often in application code or environment variables).
#### 6. **Hashing vs Encryption**

* Hashing is one-way; encryption is reversible with a key.
* Only use hashing for password storage, not encryption.

#### 7. **Common Mistakes to Avoid**

* Storing plain hashes without salt
* Using fast hash functions like SHA-256 for passwords
* Reusing salts or using predictable salts

#### 8. **Real-World Breach Examples**

* LinkedIn and Adobe breaches: Poor or missing hashing practices
* How proper hashing could have mitigated the damage


## Oauth

### 🔐 What is OAuth? — A Simple Explanation
* An open standard for **authorization**, not authentication (important distinction).
* Lets users grant access to apps without giving out their password.
* Example: “Login with Google” or “Allow this app to access your Twitter account”.

🚪 Imagine This:

You walk into a hotel and want to use the gym.

But the gym doesn't ask for your name, ID, or any password.

Instead, the hotel gives you a keycard that says:
✅ “This guest has access to the gym.”

You swipe the card, and you're in.

That’s basically how OAuth works — but for apps and websites.


### 💡 The Problem OAuth Solves

Let’s say you’re using a new app that wants to access your photos on Google Drive.

Instead of giving the app your Google password (risky!), OAuth lets you:

Click “Sign in with Google”.

Google asks: "Do you want to allow this app to view your photos?"

You say yes → Google gives the app a special key (token).

The app can now access just your photos — not your email, contacts, or password.

✅ You never shared your actual Google password with the app.
✅ You can take back access anytime.

### 🔑 Key Points (Plain English)

OAuth is like a permission slip.

It lets apps ask other services (like Google or Facebook) for access to your data — without needing your password.

You stay in control: you can say what the app can or can’t do, and for how long.

### 👥 Common Real-Life Examples

“Login with Google” or “Login with Facebook”

Giving a third-party calendar app access to your Google Calendar

Connecting your Instagram to a photo editor app

#### 3. **Authentication with OAuth: OpenID Connect**

* **OIDC = OAuth 2.0 + Identity Layer**
* Used for real login systems (e.g., “Sign in with Google”)
* Returns an **ID Token** with user info (name, email, etc.)
### 🤝 Related Term: **OpenID Connect**

* This is an extension of OAuth that also tells the app **who you are**.
* That’s how “Sign in with Google” knows your name, email, and profile picture.

### 🚫 Why Not Just Use Passwords?

* **Security risk**: You don’t want to give your password to every app.
* **Password fatigue**: Less to remember.
* **Easy to revoke**: You can stop access without changing your password.


### 🧠 Summary

| Term           | What it means                                                              |
| -------------- | -------------------------------------------------------------------------- |
| OAuth          | A way for apps to access parts of your account on another service — safely |
| Token          | A special key that gives limited access                                    |
| OpenID Connect | Adds your identity info to OAuth so you can "log in with Google"           |

---

## Session


* HTTP is stateless — every request is independent.
* A session is a way to **remember the user’s identity across requests** after login.
* Usually implemented by the server creating a **session ID**.

#### 2. **How Does a Session Work?**

* User logs in → server creates a session with a unique ID.
* Server sends the **session ID** back to the client (usually as a cookie).
* On subsequent requests, client sends the cookie → server recognizes the user.

#### 3. **Session vs Token-Based Authentication**

* Sessions: Server stores session data.
* Tokens (like JWT): Client stores token, server stateless.
* When to use each.


TODO:
There are several examples of malware targeting cookies from web browsers on the local system. Adversaries may also steal cookies by injecting malicious JavaScript content into websites or relying on User Execution by tricking victims into running malicious JavaScript in their browser.

There are also open source frameworks such as Evilginx2 and Muraena that can gather session cookies through a malicious proxy (e.g., Adversary-in-the-Middle) that can be set up by an adversary and used in phishing campaigns.

After an adversary acquires a valid cookie, they can then perform a Web Session Cookie technique to login to the corresponding web application.[^1]

http

session機制 cookies, token
    HTTP is stateless — each request is independent.

    Sessions create state — by assigning a unique ID to a user.

    This ID is stored on the client (usually in a cookie) and sent with each request.

    On the server side, the session ID maps to stored data (login status, preferences).

    Can mention how sessions expire (timeouts or logout).

---

## SIN

### 5. **Threats and Attacks on Authentication Systems**

* Brute-force and dictionary attacks
* Phishing and credential theft
* Credential stuffing
* Keyloggers and spyware
* Man-in-the-middle (MITM) attacks

### Complex password not practical
每個獨立 不重複 複雜的密碼 還要背下來 不切實際 
多台電腦與不同網站上重複利用相同的密碼

## Password decrypted
暴力破解 字典攻擊 撞庫攻擊
雜湊密碼破解 反向猜密碼 比對雜湊結果
量子 雲端計算
花多少時間破解 > 花多少錢破解

## Password Leak
儲存密碼文件外洩 密碼管理工具外洩
從系統中取得加密密碼清單，也不需要破解了
key logger

## Biometric
生物驗證失靈
仰賴密碼

## ID Verification
驗證功能程式寫的漏洞百出 沒用 EX: T MOBILE 2005 拉夸 希爾頓
Session 


d custom password retrieval tools on victims.[47][3] They have also dumped the LSASS process memory u


### 🔥 What is Session Hijacking?

Session hijacking occurs when an attacker steals or guesses the session identifier (usually a cookie) and uses it to access the victim’s active session. Since the server trusts the session ID, the attacker is treated as the legitimate user — no additional authentication needed.

# ⚠️ Session fixation vs session hijacking (short)

* **Fixation**: attacker sets/controls the session ID before login and reuses it after victim authenticates.
* **Hijacking**: attacker steals an already-active session identifier and uses it.


[^1]: https://attack.mitre.org/techniques/T1539/




