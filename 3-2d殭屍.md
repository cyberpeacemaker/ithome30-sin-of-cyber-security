# ã€17ã€‘è³‡å®‰çš„åŸç½ª ch.3-2.d æ®­å±ç¶²è·¯

What if your device was part of a cybercrime ringâ€¦ and you didnâ€™t know
Did you know that your computer could be attacking others right nowâ€”and you wouldnâ€™t even know it?

---

## ä»€éº¼æ˜¯æ®­å±ç¶²è·¯ï¼ˆBotnetï¼‰ï¼Ÿ
æ®­å±ç¶²è·¯æ˜¯ä¸€å€‹ç”±è¢«å…¥ä¾µè¨­å‚™ï¼ˆç¨±ç‚ºã€Œæ®­å±ã€æˆ–ã€Œæ©Ÿå™¨äººã€ï¼‰çµ„æˆçš„ç¶²è·¯ï¼Œé€™äº›è¨­å‚™é€šå¸¸åœ¨è¨­å‚™æ“æœ‰è€…ä¸çŸ¥æƒ…çš„æƒ…æ³ä¸‹ï¼Œè¢«æ”»æ“Šè€…ï¼ˆç¨±ç‚ºã€Œæ®­å±ç¶²è·¯ä¸»æ§è€…ã€æˆ–ã€Œæ®­å±ä¸»ã€ï¼‰é ç«¯æ§åˆ¶ã€‚

**å¸¸è¦‹ç”¨é€”**

* **DDoS attacks (Distributed Denial of Service)** â€” è€—ç›¡å¯ç”¨é »å¯¬ã€ç¶²è·¯é€£çµã€è¨˜æ†¶é«”ã€å„²å­˜ç©ºé–“æˆ– CPU ç­‰è³‡æºï¼Œè®“åˆæ³•ä½¿ç”¨è€…ç„¡æ³•å­˜å–æœå‹™ï¼›ä¼ºæœå™¨å¿™æ–¼å›æ‡‰å¤§é‡è™›å‡è«‹æ±‚è€Œç™±ç˜“ã€‚
* **Credential stuffing & brute-force attacks** â€” åˆ©ç”¨å¤§é‡å·²æ´©éœ²çš„å¸³å¯†çµ„åˆè‡ªå‹•å˜—è©¦ç™»å…¥ï¼ˆcredential stuffingï¼‰æˆ–ç”¨æš´åŠ›çŒœå¯†ç¢¼ï¼ˆbrute-forceï¼‰ï¼Œä»¥å–å¾—æœªæˆæ¬Šå­˜å–ã€‚
* **Spam and phishing email distributionï¼ˆåæ‡‰çˆéƒµå¯„è€… Reactor Mailerï¼‰** â€” å¤§é‡æ•£ç™¼åƒåœ¾éƒµä»¶æˆ–é‡£é­šéƒµä»¶ï¼Œèª˜é¨™æ”¶ä»¶äººé»æ“Šæƒ¡æ„é€£çµã€ä¸‹è¼‰é™„ä»¶æˆ–æ´©éœ²æ©Ÿå¯†è³‡è¨Šï¼›æœ‰æ™‚æœƒç”¨ç‰¹å®šå·¥å…·ï¼ˆå¦‚æ‰€ç¨±ä¹‹ Reactor Mailerï¼‰è‡ªå‹•åŒ–ç™¼é€ã€‚
* **Click fraud / ad fraud** â€” äººç‚ºæˆ–æ©Ÿå™¨äººå½é€ é»æ“Šå»£å‘Šæˆ–æµé‡ï¼Œå°è‡´å»£å‘Šä¸»æ”¯ä»˜ç„¡æ•ˆé»æ“Šè²»ç”¨ä¸¦æ‰­æ›²å»£å‘Šæˆæ•ˆæ•¸æ“šã€‚
* **Cryptocurrency mining (cryptojacking)** â€” åœ¨å—å®³è¨­å‚™ä¸Šæš—ä¸­åŸ·è¡ŒæŒ–ç¤¦è»Ÿé«”ï¼Œæ¶ˆè€— CPU/GPU è³‡æºä»¥æŒ–æ˜åŠ å¯†è²¨å¹£ï¼Œå°è‡´è£ç½®è®Šæ…¢ã€è€—é›»èˆ‡ç¡¬é«”å£½å‘½ç¸®çŸ­ã€‚
* **Proxying traffic to hide attacker identity** â€” å°‡æ”»æ“Šæµé‡è½‰ç™¼æˆ–ä»£ç†å‡ºå»ä»¥éš±è—çœŸå¯¦ä¾†æºï¼Œè®“è¿½è¹¤å’Œé˜»æ–·æ”»æ“Šè€…è®Šå¾—æ›´åŠ å›°é›£ã€‚
* **Spreading additional malware or ransomware** â€” åˆ©ç”¨å·²å…¥ä¾µçš„è¨­å‚™æ•£å¸ƒæ›´å¤šæƒ¡æ„è»Ÿé«”æˆ–å‹’ç´¢ç¨‹å¼ï¼Œæ“´å¤§æ„ŸæŸ“ç¯„åœæˆ–åŠ å¯†å—å®³è€…è³‡æ–™ä»¥ç´¢å–è´–é‡‘ã€‚
* **Data theft (Log keystrokes, steal passwords or banking info.)** â€” ç«Šå–éµç›¤ç´€éŒ„ã€å¯†ç¢¼ã€éŠ€è¡Œèˆ‡å€‹äººè³‡æ–™ç­‰æ•æ„Ÿè³‡è¨Šï¼Œç”¨æ–¼èº«ä»½ç›œç”¨ã€è©é¨™æˆ–è²©å”®æ–¼åœ°ä¸‹å¸‚å ´ã€‚
* **Selling access: Botnets as a service (BaaS) on the dark web.** â€” æ”»æ“Šè€…æŠŠå·²æ§åˆ¶çš„è¨­å‚™æˆ–æ•´å€‹ botnet ç•¶ä½œæœå‹™å‡ºå”®æˆ–ç§Ÿå€Ÿï¼Œä»–äººå¯ä»˜è²»ç™¼å‹•æ”»æ“Šæˆ–åŸ·è¡Œæƒ¡æ„ä»»å‹™ã€‚
TODO:
* **æµé‡** â€”ï¼ˆçœ‹èµ·ä¾†æ˜¯æé†’è©ï¼‰æŒ‡çš„æ˜¯ç”± botnet ç”¢ç”Ÿçš„å¤§é‡ç¶²è·¯æµé‡ï¼Œå¯ç”¨æ–¼ç™±ç˜“æœå‹™ã€éš±åŒ¿æ”»æ“Šä¾†æºæˆ–é€ æˆè¨ˆé‡å‹è²»ç”¨æš´å¢ã€‚
* **Adversarial attacks Some botnets are designed to exploit software vulnerabilities or to assist in ransomware campaigns.** â€” æŸäº› botnet å°ˆé–€ç”¨ä¾†æƒæä¸¦åˆ©ç”¨è»Ÿé«”æ¼æ´å–å¾—æ›´æ·±å±¤æ§åˆ¶ï¼Œæˆ–ä½œç‚ºå”åŠ©å‹’ç´¢è»Ÿé«”æ”»æ“Šçš„å·¥å…·ï¼ˆä¾‹å¦‚ç”¨ä¾†æ•£æ’­å‹’ç´¢è¼‰è·æˆ–é˜»æ–·æ•‘æ´é€šé“ï¼‰ã€‚

### åŸºæœ¬çµ„æˆéƒ¨åˆ†ï¼š

* æ®­å±ç¶²è·¯ä¸»æ§è€…ï¼æ§åˆ¶è€…ï¼šæ§åˆ¶æ®­å±ç¶²è·¯çš„äººæˆ–çµ„ç¹”ã€‚
* æŒ‡æ®èˆ‡æ§åˆ¶ï¼ˆC2ï¼‰åŸºç¤è¨­æ–½ï¼šæ®­å±æ¥æ”¶æŒ‡ä»¤çš„æ©Ÿåˆ¶ã€‚
* æ®­å±ï¼æ©Ÿå™¨äººï¼šè¢«æ„ŸæŸ“çš„è¨­å‚™ï¼ˆåŒ…æ‹¬å€‹äººé›»è…¦ã€ç‰©è¯ç¶²è£ç½®ã€ä¼ºæœå™¨ã€è¡Œå‹•è£ç½®ç­‰ï¼‰ã€‚
## Payload, Beacon & C2

* **Payload** = the malware binary/module that executes on the victim (what does the malware *do*?).
* **Beacon** = the periodic network â€œcall homeâ€ the infected host makes to check for instructions (how the payload *contacts* the controller).
* **C2 (Command & Control)** = the infrastructure the attacker uses to receive beacons and issue commands (where the payload gets orders and updates).

Think: *payload runs â†’ beacon calls C2 â†’ C2 replies with commands or additional payloads â†’ payload executes commands or fetches more modules.*

### 2. **How Botnets Work**

* **Step-by-step process**:
1. æ”»æ“Šè€…è£½ä½œæˆ–è³¼è²·æƒ¡æ„ç¨‹å¼ï¼ˆmalware / payloadï¼‰ã€‚
2. æƒ¡æ„ç¨‹å¼è—‰ç”±é‡£é­šéƒµä»¶ã€æƒ¡æ„ä¸‹è¼‰æˆ–ç€è¦½å™¨å³æ™‚æ”»æ“Šï¼ˆdrive-byï¼‰æ•£æ’­ä¸¦åˆæ¬¡æ”»é™·ç›®æ¨™ã€‚
3. æŠ•æ”¾å™¨ï¼ˆdropperï¼‰å°‡payloadå¯«å…¥ç£ç¢Ÿï¼Œå»ºç«‹æŒä¹…æ€§ï¼ˆpersistenceï¼‰ã€‚
4. payload å•Ÿå‹•å›å ±ç¨‹å¼ï¼ˆbeaconï¼‰ï¼Œå®šæœŸè¯çµ¡æ§åˆ¶ç«¯ï¼ˆC2ï¼Œå¦‚é€é HTTPS POST åˆ°æŸå€‹åŸŸåï¼‰ã€‚
5. æ§åˆ¶ç«¯å›å‚³æŒ‡ä»¤ï¼ˆä¾‹å¦‚ä¸‹è¼‰é¡å¤–æ¨¡çµ„ã€åŸ·è¡Œå‘½ä»¤ã€è¨­å®šå¤–æ´©è·¯å¾‘ï¼‰ã€‚
6. payload æŒ‰æŒ‡ä»¤åŸ·è¡Œï¼ˆåµå¯Ÿï¼reconã€å¸³å¯†ç«Šå–ã€å´å‘ç§»å‹•ç­‰ï¼‰ï¼Œä¸¦å¯èƒ½åˆ†éšæ®µéƒ¨ç½²å…¶ä»–æƒ¡æ„è»Ÿé«”ï¼ˆä¾‹å¦‚ä¹‹å¾Œå†æ”¾å‹’ç´¢è»Ÿé«”ï¼‰ã€‚

## Payloadï¼ˆæœ‰æ•ˆè² è¼‰ï¼‰ä»‹ç´¹ â€” ç¹é«”ä¸­æ–‡ç°¡æ˜èªªæ˜

**Payloadï¼ˆæœ‰æ•ˆè² è¼‰ï¼‰**æŒ‡æ”»æ“Šè€…æ”¾åˆ°è¢«å®³ç³»çµ±ä¸Šã€å¯¦éš›åŸ·è¡Œæƒ¡æ„ç›®çš„çš„ç¨‹å¼ç¢¼ï¼æ¨¡çµ„ã€‚å®ƒæ˜¯å…¥ä¾µéˆä¸­ã€Œåšäº‹ã€çš„é‚£ä¸€æ®µï¼šè’é›†è³‡æ–™ã€å»ºç«‹å¾Œé–€ã€ä¸‹è¼‰å…¶ä»–æ¨¡çµ„ã€æ©«å‘ç§»å‹•æˆ–éƒ¨ç½²å‹’ç´¢è»Ÿé«”ç­‰ã€‚ä¸‹é¢æŠŠå¸¸è¦‹é¡å‹ã€`staged` vs `stageless` æ¦‚å¿µã€å¯¦å‹™è€ƒé‡ã€åµæ¸¬èˆ‡é˜²è­·ä¸€æ¬¡èªªæ¸…æ¥šã€‚

### Payload çš„å¸¸è¦‹é¡å‹ï¼ˆé«˜éšåˆ†æ³•ï¼‰

* **Dropper / Installerï¼ˆæŠ•æ”¾ç¨‹å¼ï¼‰**ï¼šæŠŠå…¶ä»–æƒ¡æ„æª”æ¡ˆå¯«å…¥ç£ç¢Ÿä¸¦å»ºç«‹æŒä¹…æ€§ã€‚é€šå¸¸æœ¬èº«ä¸åšå¤ªå¤šå‹•ä½œï¼Œåªè² è²¬å®‰è£ã€‚
* **Downloader / Fetcherï¼ˆä¸‹è¼‰å™¨ï¼‰**ï¼šé€£å› C2 ä¸‹è¼‰ä¸» payloadï¼ˆstageï¼‰ã€‚
* **Implant / Backdoorï¼ˆæ¤å…¥é«” / å¾Œé–€ï¼‰**ï¼šå¸¸é§è¨˜æ†¶é«”æˆ–ç³»çµ±ï¼Œæ¥æ”¶é ç«¯æŒ‡ä»¤æˆ–é–‹æ”¾é€šé“ã€‚
* **Beacon / Beaconing æ¨¡çµ„**ï¼šè² è²¬èˆ‡ C2 è¯çµ¡ï¼Œå›å ±ç‹€æ…‹ä¸¦é ˜å–æŒ‡ä»¤ã€‚
* **Moduleï¼ˆæ¨¡çµ„ï¼‰**ï¼šç‰¹å®šåŠŸèƒ½ï¼ˆcredential theftã€keyloggerã€ransomware payloadã€DDoS æ¨¡çµ„ ç­‰ï¼‰ã€‚
* **Loader / Shellcode**ï¼šè¼ƒä½éšï¼Œç”¨æ–¼æŠŠè¨˜æ†¶é«”å…§çš„ code åŸ·è¡Œèµ·ä¾†ï¼ˆä¾‹å¦‚ exploit å¾Œæ³¨å…¥çš„ shellcodeï¼‰ã€‚

### Staged vs Stagelessï¼ˆåˆ†éšæ®µèˆ‡ç„¡éšæ®µï¼‰æ ¸å¿ƒæ¦‚å¿µ

**Stagedï¼ˆåˆ†éšæ®µï¼‰**

* **å®šç¾©**ï¼šåˆæœŸ payloadï¼ˆç¨±ç‚º stage0ï¼Œä¾‹å¦‚ dropper æˆ– downloaderï¼‰å¾ˆå°ï¼ŒåŸ·è¡Œå¾Œå†å¾ C2 æˆ–é ç«¯ä½ç½®ä¸‹è¼‰æ›´å¤§çš„ä¸»è¦ payloadï¼ˆstage1ã€stage2 ...ï¼‰ã€‚
* **å„ªé»**ï¼šåˆå§‹æª”æ¡ˆè¼ƒå°ã€è¼ƒé›£è¢«éœæ…‹ç°½åæ¯”å°æ””æˆªï¼›æ”»æ“Šè€…å¯å‹•æ…‹é¸æ“‡/æ›´æ–°å¾ŒçºŒæ¨¡çµ„ï¼›åˆ†éšæ®µå¯å»¶é²é¢¨æš´å¼æ´»å‹•é™ä½æ—©æœŸåµæ¸¬æ©Ÿæœƒã€‚
* **ç¼ºé»**ï¼šä¸‹è¼‰éšæ®µæœƒç”¢ç”Ÿç¶²è·¯è¡Œç‚ºï¼ˆæ˜“ç•™ä¸‹ç—•è·¡ï¼‰ï¼›è‹¥ C2 è¢«å°é–æˆ–è¨»å†ŠåŸŸåå¤±æ•ˆï¼Œå¾ŒçºŒéšæ®µå¤±æ•—ã€‚
* **å¸¸è¦‹å ´æ™¯**ï¼šåˆ©ç”¨ downloader ä¸‹è¼‰ Meterpreterã€Cobalt Strike ä¹‹é¡çš„ payloadï¼ˆç¤ºæ„ç”¨é€”ï¼‰ã€‚

**Stagelessï¼ˆç„¡éšæ®µ / å–®é«”ï¼‰**

* **å®šç¾©**ï¼šåˆå§‹æŠ•å…¥çš„ payload æœ¬èº«å°±æ˜¯å®Œæ•´çš„æƒ¡æ„ç¨‹å¼ï¼Œä¸å†å‘å¤–ä¸‹è¼‰ä¸»è¦åŠŸèƒ½ï¼›ä¸€å€‹æª”æ¡ˆï¼ˆæˆ–è¨˜æ†¶é«”å¡Šï¼‰å³å®Œæˆæ‰€æœ‰åŠŸèƒ½ã€‚
* **å„ªé»**ï¼šåŸ·è¡Œæ™‚ä¸éœ€å†è¯ç¶²ä¸‹è¼‰å¤§é‡ç¨‹å¼ï¼Œæ¸›å°‘å¤–éƒ¨ç¶²è·¯è¶³è·¡ï¼›å°æŠ— C2 å°é–æ›´æœ‰å½ˆæ€§ï¼ˆæœ¬é«”å·²å…·å‚™åŠŸèƒ½ï¼‰ã€‚
* **ç¼ºé»**ï¼šåˆå§‹æª”æ¡ˆé€šå¸¸è¼ƒå¤§ï¼Œå®¹æ˜“è¢«éœæ…‹åˆ†ææˆ–ç°½ååµæ¸¬åˆ°ï¼›ç¼ºä¹æ”»æ“Šè€…åœ¨åŸ·è¡Œæ™‚å‹•æ…‹æ›´æ› payload çš„ä¾¿åˆ©ã€‚
* **å¸¸è¦‹å ´æ™¯**ï¼šä¸€æ¬¡æ€§æ¤å…¥çš„å‹’ç´¢è»Ÿé«”æ¨£æœ¬ã€ç´”è¨˜æ†¶é«”æ”»æ“Šçš„å–®æª” implantï¼ˆåœ¨è¨˜æ†¶é«”åŸ·è¡Œä¸”ä¸å†å–ä¸‹ä¸€æ­¥ï¼‰ã€‚

## ä»€éº¼æ˜¯ beaconï¼Ÿ

**Beacon** æŒ‡è¢«æ„ŸæŸ“ä¸»æ©Ÿå®šæœŸå‘å…¶ C2 ç™¼å‡ºçš„ç¶²è·¯è¯çµ¡ï¼Œç”¨ä¾†ï¼š

* æª¢æŸ¥æ˜¯å¦æœ‰æ–°æŒ‡ä»¤ï¼Œ
* å‚³é€ç‹€æ…‹ï¼å…ƒè³‡æ–™ï¼Œ
* å°è¦æ¨¡å¤–æ´©è³‡æ–™ï¼Œ
* ä¸‹è¼‰æˆ–å–å¾—é¡å¤–æ¨¡çµ„ã€‚

### Beacon çš„è¡Œç‚ºç‰¹æ€§

* **é–“éš”ï¼ˆIntervalï¼‰**ï¼šå›ºå®šï¼ˆä¾‹å¦‚æ¯ 60 ç§’ï¼‰æˆ–éš¨æ©ŸåŒ–ä»¥é¿é–‹åµæ¸¬ã€‚æœ‰äº›å¯¦ä½œä½¿ç”¨æŒ‡æ•¸é€€é¿ã€‚
* **beacon çš„è² è¼‰ï¼ˆPayloadï¼‰**ï¼šé€šå¸¸ç‚ºå°å‹ JSONã€Base64 äºŒé€²ä½å¡Šã€åŠ å¯†è³‡æ–™ï¼Œæˆ–ç·¨ç¢¼æ–¼ DNS å­ç¶²åŸŸæ¨™ç±¤ä¸­ã€‚
* **æŠ–å‹•ï¼ˆJitterï¼‰**ï¼šåœ¨æ™‚é–“ä¸Šåšå°å¹…è®ŠåŒ–ä»¥é¿å…ä»¥ç°½åç‚ºåŸºç¤çš„åµæ¸¬ã€‚
* **ç¡çœ æ¨¡å¼ï¼ˆSleep modesï¼‰**ï¼šé•·æ™‚é–“ä¼‘çœ å¾Œçªç™¼æ´»å‹•ã€‚
* **å›å‘¼æ¨¡å¼ï¼ˆCallback patternsï¼‰**ï¼šé‡è©¦æ¬¡æ•¸ã€ä½¿ç”¨å¤šå€‹å‚™æ´ç¶²åŸŸæˆ– IP çš„ç­–ç•¥ã€‚


# 2) C2ï¼ˆæŒ‡æ®èˆ‡æ§åˆ¶ï¼‰

ä»£ç†ä¸­ç¹¼ä¼ºæœå™¨ proxy relay ä¸­æ®µä¼ºæœå™¨ middle server
The attackerâ€™s own communications out of their infrastructure will likely be anonymized â€” that is, bounced through a series of proxy servers to hide their true identity

As mentioned above, a beacon or payload is an executable or program that communicates back to the attacker via some communication channel. This may be **secured over HTTPS** or use a **plain-text protocol such as DNS**.
TODO: SMB PIVOT, , 

## æ¶æ§‹

* **é›†ä¸­å¼ï¼ˆç¶“å…¸ï¼‰**ï¼šå–®ä¸€ C2 ä¼ºæœå™¨æˆ–å°å‹ä¼ºæœå™¨ç¾¤ï¼ˆHTTP/HTTPSã€IRCã€è‡ªè¨‚ TCPï¼‰ã€‚ç°¡å–®ä½†æœ‰å–®é»æ•…éšœé¢¨éšªã€‚
* **é»å°é»ï¼ˆP2Pï¼‰**ï¼šæ„ŸæŸ“ä¸»æ©Ÿå½¢æˆç¶²ç‹€çµæ§‹ï¼›æŒ‡ä»¤åœ¨ç¯€é»é–“å‚³æ’­ï¼ˆè¼ƒé›£ä¸€èˆ‰éŸé™¤ï¼‰ã€‚
* **å»ä¸­å¿ƒåŒ– / æ¿«ç”¨é›²ç«¯æœå‹™**ï¼šåˆ©ç”¨é›²ç«¯æœå‹™ã€ç¤¾äº¤å¹³å°ã€å…¬é–‹ API æˆ–ç¬¬ä¸‰æ–¹è¨—ç®¡ã€‚
* **Fastâ€‘flux / ç¶²åŸŸè¼ªæ›**ï¼šé »ç¹è®Šæ›´ DNS ç´€éŒ„ä»¥éš±è— C2 çš„å¯¦é«” IPã€‚
* **ç¶²åŸŸç”¢ç”Ÿæ¼”ç®—æ³•ï¼ˆDGAï¼‰**ï¼šæƒ¡æ„ç¨‹å¼è¨ˆç®—å¤§é‡ç¶²åŸŸåç¨±ä¸¦å˜—è©¦é€£ç·šï¼›æ”»æ“Šè€…åªè¨»å†Šå…¶ä¸­éƒ¨åˆ†ã€‚
* **éš±å¯«ï¼éš±è”½é€šé“**ï¼šé€é DNS TXTã€ICMPã€Tor æˆ–ç¤¾äº¤å¹³å°ç­‰æ–¹å¼å‚³é C2 æŒ‡ä»¤ï¼›å°‡å‘½ä»¤è—åœ¨çœ‹ä¼¼ç„¡å®³çš„æµé‡ä¸­ã€‚

## å¸¸è¦‹å”å®šèˆ‡æŠ€è¡“

* **HTTP/Sï¼ˆGET/POSTï¼‰** â€” èˆ‡æ­£å¸¸ç¶²é æµé‡æ··åˆã€‚å¯èƒ½ä½¿ç”¨ TLSã€‚
* **DNS æŸ¥è©¢**ï¼ˆåˆ©ç”¨ TXT æˆ–å­ç¶²åŸŸæ¨™ç±¤ä¾†å¤–æ´©è³‡æ–™ï¼‰ã€‚
* **è‡ªè¨‚ TCP/UDP å”å®šã€IRC**ã€‚
* **ä½¿ç”¨åˆæ³•æ†‘è­‰ï¼CDN çš„ HTTPS** ä¾†æ··æ·†æµé‡ä¾†æºã€‚
* **é›»å­éƒµä»¶ã€é›²ç«¯å„²å­˜ï¼ˆå¦‚ S3ã€Dropboxï¼‰** ä½œç‚ºéåŒæ­¥ C2 é€šé“ã€‚

**DNScat2**
One important part of this infrastructure is the Domain Name System (DNS). An attacker can leverage DNS to deliver malicious communications to their infrastructure, and they can also use DNS to exfiltrate (that is, steal) data.

## shell code
An exploit is often separate from the beacon or payload. However, the two are commonly put together as shellcode

Once the exploit gains access to the target system, it will load a small beacon or payload that can call back to the attacker to complete the attack, a process known as payload staging.

#### Botkit
bootkit æ„ŸæŸ“ä¸»å•Ÿå‹•ç´€éŒ„MBRé€²è¡ŒæŒä¹…ç•«

## lateral movement
As shown below, they can also upload Mimikatz, a malicious tool for stealing user credentials. Attackers need credentials with elevated privileges to perform system-level actions and lateral movement inside a network.

## Persistence mechanisms

* Registry Run keys (Windows), systemd timers/services (Linux), cron jobs, startup folders, firmware-level persistence for advanced threats.

Another critical step for the attacker is creating a **route back to the victim machine, even after it has been rebooted by the user**. This is where the technique of persistence comes into play. Attackers have several ways to achieve this, including autorun reverse payloads and persistent backdoors.

As shown below, the attacker chooses to run a post-exploit persistence module, which involves a Visual Basic Script (VBScript) placed in the Windows Temp folder of the logged-on user, UoPfNwo.vbs. The attacker then installs a Windows registry entry to enable the script to autorun after the machine boots up.

### Evasion techniques used by botnets
#### memory-only
memory-only dropper
polymorphic bots
## Packing, obfuscation, and evasions

* Packers, crypters, and polymorphism to avoid static detection.
* Use of living-off-the-land binaries (LOLBins) to run code via signed system tools.
* In-memory execution (fileless) to avoid disk artifacts.

#### rootkit
ä¸€å¥—å¯ä»¥é ç«¯æ§åˆ¶ä¸»æ©Ÿçš„å¾Œå€‘ç¨‹å¼(backdoor)æˆ–æœ¨é¦¬ç¨‹å¼(trojan)
éš±è—
æœ€é«˜æ¬Šé™root

Now the attacker has ensured that their payload script can connect back to their listener, even if the machine is rebooted. However, files on the disk can now also be detected by a file system antivirus (AV) scan.

Finally, the attacker will want to clean up all potential evidence. To do this, they may remove original malicious files and entries, and encrypt or even mix malicious files among legitimate system files. To further cover their tracks, they can also delete both shadow copies and system logs.

The ability to start **new processes** is very useful. The attacker can start a new unsuspecting process like notepad.exe and then **migrate their original malicious payload process to it using code / DLL injection**. Itâ€™s a technique that makes a malicious process on the system appear to be legitimate

---

# example
Netcurs 900è¬å°[^1]
miraiä¾¿å¯µ drake dingle chickenmelon 70è¬ç³»çµ± 100GB/sæµé‡
å€¼å¾—é—œæ³¨çš„æ˜¯ï¼Œæ®­å±ç¶²è·¯æ”»æ“Šå¾æ„ŸæŸ“è£ç½®åˆ°å®Œå…¨æ¸…é™¤çš„å¹³å‡æ™‚é•·ï¼Œåœ¨2023å¹´ä¸ŠåŠå¹´æ”€å‡è‡³è¿‘1.5å€‹æœˆï¼Œæ˜¯5å¹´å‰çš„1000å€ä»¥ä¸Šï¼Œé€™ä¹Ÿæ„å‘³è‘—æ®­å±ç¶²è·¯å°å—æ„ŸæŸ“ä¼æ¥­çš„å½±éŸ¿æ™‚é–“å°‡å¤§å¹…æ‹‰é•·ï¼Œå¯èƒ½é€ æˆæ›´åŠ é¾å¤§çš„è³‡å®‰é¢¨éšªèˆ‡ç‡Ÿé‹æå¤±ã€‚[^9]
* ğŸ•·ï¸ **Mirai**: Famous IoT botnet that took down major websites (Netflix, Twitter) via DNS provider Dyn in 2016.
* ğŸ¦  **Emotet**: Started as banking malware, evolved into a modular botnet for spam and malware distribution.
* ğŸ‘¾ **Zeus/Zbot**: Banking trojan with MITB features, often used in botnets.
* âš ï¸ **QakBot**: Multifunction botnet used for ransomware delivery before its takedown in 2023.

* **Mirai Botnet**: Brought down major websites like Twitter, Netflix via DDoS in 2016
* **Zeus/Zbot**: Banking Trojan used for credential theft
* **Emotet**: Once one of the most dangerous botnets for spam and malware delivery

--- 

## åŸç½ª

### 6.é€šè¨Šå¡è»Š

é¡›å³°æ™‚æ®µå¡è»Šæ­£å¸¸ã€‚ä½†ç„¡æ³•é˜»æ­¢æœ‰äººéš¨æ„æ§åˆ¶æˆç¾¤è»Šå­è£½é€ å¡è»Š

### è²¬ä»»è½‰ç§»
æ®­å±é›»è…¦çš„å…ƒå…‡ã€‚ä½†è²¬ä»»å»è½‰ç§»åˆ°è¦æ™®é€šæ°‘çœ¾ä¸æˆç‚ºæ®­å±ï¼Œå›°é›£

### å…¬åœ°æ‚²åŠ‡
ä»–äººæ”¶åˆ°åƒåœ¾éƒµä»¶æˆ–é­åˆ°é˜»æ–·æœå‹™æ–¼ï¼Œè‡ªå·±ç„¡é—œï¼Œ

### 
DDOS æ­£å¸¸ç¾è±¡ æ˜¯ç¾è±¡è¢«æ¿«ç”¨
é é˜²DDOS æå‡é‹ç®—è³‡æº æµªè²»éå¤šè³‡æºæˆæœ¬
DDoSæ®­å±ç¶²è·¯æ™®éé–å®šLinuxã€ç‰©è¯ç¶²è£ç½®[^6]

## é€£ç·šé€šè¨Šæ©Ÿåˆ¶

- TCPæ©Ÿåˆ¶ SYNæ´ªæ°´
- UDPæ´ªæ°´æ”»æ“Š


### **3. Infection & Propagation Vectors**

* **Phishing emails** (with trojans)
* **Drive-by downloads**
* **Exploiting unpatched software or open ports**
* **Malicious browser extensions or cracked software**
* **IoT devices with default credentials or no firmware updates**

[^1]: https://www.cic.police.ntpc.gov.tw/cp-755-73423-28.html
[^6]: https://www.ithome.com.tw/news/169020
[^2]: https://www.bleepingcomputer.com/news/security/ddos-defender-targeted-in-15-bpps-denial-of-service-attack/