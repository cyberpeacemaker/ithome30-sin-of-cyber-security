# 【18】資安的原罪 ch.3-2.e 供應鏈攻擊

Supply‑chain attacks don’t break through your firewall — they arrive inside as trusted code. By attacking vendors, build pipelines, or package registries, adversaries can distribute malicious artifacts at scale.

---

1. **Start from the foundation: Trusted Relationships**
   Explain that at the core of any content or software delivery lies a network of *trust relationships*. These relationships define who is allowed to produce, modify, and deliver code/data, and how recipients verify authenticity.

---

## 什麼是供應鏈攻擊
 **Introduce Supply Chain Attacks as a breach of trust upstream**
   Show how compromising trusted upstream parties or tooling breaks trust, allowing malicious code or compromised artifacts to propagate widely before detection.


供應鏈攻擊（supply-chain attack）是指攻擊者針對許多組織依賴的軟體、硬體或服務提供商，而**非直接攻擊最終目標**。透過入侵受信任的供應商（例如程式碼、函式庫、持續整合管線、更新伺服器、韌體、託管服務），攻擊者能將惡意程式碼或操控分散給眾多下游受害者，而這些受害者會默認信任這些元件。


## Why supply‑chain attacks are powerful

* They abuse **trust**: organizations implicitly trust vendors, libraries, or updates.
* They **scale**: one compromise can reach thousands of victims (wide blast radius).
* They can **bypass perimeter defenses**: malicious code arrives signed or from trusted hosts.
* They’re **hard to detect**: malware looks like legitimate updates or vendors’ artifacts.


## 典型攻擊向量

### How to slot them in your structure

Here’s a refined taxonomy incorporating them:

1. **Software/Build Supply Chain**

   * Code repos, CI/CD, package registries, build servers.
   * Includes *web app source code* and its dependencies.

2. **Hardware/Firmware Supply Chain**

   * Components, firmware, hardware vendors.

3. **Service/Cloud Supply Chain**

   * **Cloud service providers and platforms** (IaaS, PaaS, SaaS).
   * Includes cloud APIs, container registries, managed services.
   * Attacks: compromised cloud accounts, insider threats, API manipulation.

4. **Network/Delivery Supply Chain**

   * ISPs, transit providers, caching proxies, middleboxes injecting or modifying traffic.
   * ISP content injection fits here.

5. **Third-Party Content Supply Chain**

   * External scripts, analytics, ad networks, widgets integrated into web apps.


## 被入侵的建置（CI/CD）管線

當攻擊者取得建置或持續整合／持續部署（CI/CD）流水線的存取權或權限，他們可以在軟體編譯、打包或產生部署產物的階段注入惡意程式碼或替換產物。例如：在**建置步驟**中插入後門、修改簽章流程、或用篡改後的二進位檔取代原本的發行檔。
影響： 被散發到下游客戶或生產環境的軟體將含有惡意行為，受害範圍可能廣且難以追蹤，因為攻擊來自看似「可信任」的發行物。

## 被植入後門的函式庫或套件

攻擊者上傳惡意的開源套件到**公有套件庫**（例如 NPM、PyPI、Maven），或入侵並替換受歡迎的套件，讓依賴該套件的專案在安裝或執行時執行攻擊者的程式碼。惡意程式碼可能藏於看似微小的程式庫中或以版本更新的形式出現（typosquatting、依賴鏈傳播）。
影響： 眾多使用該套件的應用將成為受害者，攻擊可能竊取密碼、洩露資料、或在使用者環境植入持久後門。

## 被入侵的供應商更新伺服器

攻擊者入侵軟體供應商的更新服務或簽章流程，將含有惡意程式的更新透過正常的自動更新機制推送給所有使用者。即使更新通道看似「簽名」或「官方」，若簽章金鑰或部署流程被破壞，惡意更新也會被接受。
影響： 受信任的更新直接觸及大量終端或伺服器，能迅速擴散惡意程式並繞過使用者防備。

## 第三方託管服務被濫用或入侵

當託管服務供應商（Managed Service Provider, MSP）或**雲端服務提**供者被入侵或其權限被濫用，攻擊者可以利用**供應商對多個客戶環境**的集中管理權限來橫向移動、竊取資料或植入後門。由於管理端對多個客戶都有存取能力，此類攻擊能擴及大量受害者。
影響： 受影響的客戶可能面臨資料洩露、服務中斷或系統完整性遭破壞，且追蹤責任邊界複雜。

## 硬體或韌體被植入惡意程式

硬體或韌體在製造、組裝或運輸階段被植入惡意元件或惡意韌體（例如：替換晶片、修改出廠韌體），導致設備出廠時就已被後門化。這種攻擊可能出現在供應鏈的物理層面，且非常難以在軟體層完全偵測。
影響： 一旦設備被出廠植入惡意程式，攻擊者可取得長期、低檢測率的存取權，能夠監控、竊取或破壞資料與功能。

## 供應商內部人員（內部威脅）

供應商內部的員工（如開發者、系統管理員或外包人員）因惡意或在壓力/脅迫下，修改或在交付物中加入惡意程式碼、後門或弱化安全性的設定。內部人士通常擁有高權限，因此能在不易被外界發現的情況下更改產品或服務。
影響： 受信任的交付物被破壞會直接傳播到客戶端，且事件調查常受限於供應商內部資料的可得性。


## Cloud services & web apps

## ISP Content Injection
**Present Content Injection as a breach of trust in transit/delivery**
   Highlight that even if the source is secure, trust can be broken en route—when ISPs or middleboxes insert or modify content, affecting end users downstream.

## Trust Relationship
TODO:
MTIRE {
    Adversaries may breach or otherwise leverage organizations who have access to intended victims. Access through trusted third party relationship abuses an existing connection that may not be protected or receives less scrutiny than standard mechanisms of gaining access to a network.

Organizations often grant elevated access to second or third-party external providers in order to allow them to manage internal systems as well as cloud-based environments. Some examples of these relationships include IT services contractors, managed security providers, infrastructure contractors (e.g. HVAC, elevators, physical security). The third-party provider's access may be intended to be limited to the infrastructure being maintained, but may exist on the same network as the rest of the enterprise. As such, Valid Accounts used by the other party for access to internal network systems may be compromised and used.[1]

In Office 365 environments, organizations may grant Microsoft partners or resellers delegated administrator permissions. By compromising a partner or reseller account, an adversary may be able to leverage existing delegated administrator relationships or send new delegated administrator offers to clients in order to gain administrative control over the victim tenant.[2]
}


## Similarities
4. **Tie them back together: Both break the chain of trust, enabling attackers to manipulate data/code**
   Emphasize that while the mechanisms differ, the root cause and risk is the *breakdown or abuse of trusted relationships*.

| Aspect                 | Content Injection                                                                                        | Supply Chain Attacks                                                                                              | Trusted Relationships                                                                                                       |
| ---------------------- | -------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| **Core concept**       | Unauthorized modification of content/data during delivery.                                               | Compromise or manipulation of components or processes in the production/delivery pipeline.                        | The implicit or explicit trust placed in a third party or intermediary to deliver unaltered, authentic content or services. |
| **Trust violation**    | Breaks trust between content origin and end user by injecting/modifying content.                         | Breaks trust by compromising upstream providers or tools relied upon in creating or delivering software/data.     | Establishes the framework under which parties rely on each other’s integrity, security, and authenticity.                   |
| **Impact**             | End users receive altered or malicious content without origin server's consent.                          | Downstream systems/users receive compromised software or data, potentially widespread and persistent.             | Enables all parties to operate securely and efficiently; when broken, can lead to supply-chain or injection attacks.        |
| **Scale & reach**      | Can affect multiple users on a network or region if the ISP or intermediary is compromised or malicious. | Can affect all consumers of a compromised repository, service, or hardware provider globally or organizationally. | Trust relationships are foundational to enable large-scale distribution and usage of software and services.                 |
| **Mitigation overlap** | Encryption, certificate validation, content signing, monitoring.                                         | Secure build processes, code signing, dependency vetting, provenance tracking, monitoring.                        | Audits, contracts, SLA, transparency, monitoring, cryptographic controls.                                                   |

---

## Differences

| Aspect                  | Content Injection                                                                                     | Supply Chain Attacks                                                                                                     | Trusted Relationships                                                                                           |
| ----------------------- | ----------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------- |
| **Stage of attack**     | Occurs *in transit* — during delivery of content from server to user.                                 | Occurs *upstream* — during creation, build, packaging, or distribution of software/hardware.                             | Exist continuously at all stages—defining who and what is trusted during creation and delivery.                 |
| **Technical mechanism** | Packet or protocol manipulation (HTTP, DNS, TLS interception), caching injection, proxy modification. | Compromise of source code, CI/CD, package repos, third-party libraries, firmware, or hardware.                           | Not a technical attack but a relationship or security model; breaches in these relationships enable attacks.    |
| **Visibility to user**  | Often easier to detect (browser shows unexpected scripts, cert warnings, or ads).                     | Often harder to detect—compromise can be stealthy, embedded in trusted artifacts.                                        | Invisible until broken; often discovered after the fact via audits or incident response.                        |
| **Examples**            | ISP ad injection, TLS MITM with forged certs, DNS spoofing, transparent proxies.                      | Code-signing key theft, malicious NPM package, tampered firmware, compromised cloud build system.                        | Developer trusting a third-party package, user trusting CDN or cloud provider, org trusting supplier contracts. |
| **Scope of trust**      | Network or service provider trusted to deliver unaltered content.                                     | Software/hardware vendors, build services, repositories, and third-party providers trusted to supply genuine components. | Contractual, cryptographic, or operational trust linking entities in the supply chain.                          |


---

## Example

* **SolarWinds (2020)** — attackers inserted malicious code into a vendor’s build, delivered via trusted updates to thousands of orgs.
* **Kaseya (2021)** — attackers abused an MSP platform to push ransomware to customers.
* **Compromised OSS packages** (various incidents) — malicious packages or typosquatting in package registries.
* **Log4Shell / Log4j** is often discussed with supply‑chain risk because a vulnerable widely‑used component produced huge downstream risk (not an insertion, but shows dependency risk).

供應鏈攻擊讓駭客得以冒充合法軟體，同時入侵多臺電腦，未來可能數量會更多，以特定地區或產業內知名的服務為攻擊目標。

Solarwind 在更新黨植入惡意軟體 世界各地信任solarwinds的政府機構與民間企業就全部變成駭客的後花園
北約機構 英國政府 歐盟議會 微軟
微軟總砸 brad smith solarwinds入侵是史上最大最複雜的攻擊

Docker Hub[^6] Github[^7] [^9] NPM[^8] 輸入法[^10] VScode Extension[^12] Go模組[^15]

針對去年中國駭客對臺灣無人機產業發動的供應鏈攻擊，趨勢科技公布新的調查結果，指出這些駭客自2023年發起另一波攻擊行動Venom，由於大量使用各式開源工具，使得相關攻擊難以被察覺
根據攻擊手法，研究人員指出大致可分成兩種類型。其中一種是將惡意程式碼注入一般的應用程式，或是將竄改的版本與軟體更新套件調包，從而藉由向下游客戶提供合法軟體的傳遞管道，散布惡意程式。
另一種手法則是在無法置換更新套件或注入惡意程式碼的時候運用，駭客先攻擊上游供應商，再透過遠端監控工具或IT管理工具，對受害組織散布惡意軟體，而能在不竄改軟體的情況下，從上游供應商橫向移動到下游的目標。[^11]

這起事件問題出在多重簽章（Multisig）錢包解決方案Safe{Wallet}。駭客透過精心設計的網路釣魚攻擊，竊取了一名Safe開發者的憑證，導致攻擊者能以未經授權存取Safe{Wallet}的基礎設施[^14]

2013 紐約時報域名註冊 Melbourne 竄改DNS紀錄 當使用者輸入紐約時報致常網指nytimes.com 就會看到敘利亞殘暴組織的網站
北韓駭客組織Lazarus以軟體供應鏈手法攻擊南韓用戶[^1]
Lazarus駭入獲得VeraPort認證，且擁有合法數位憑證的網誌服務器，然後有惡意軟體植入遭駭的網站中。一旦安裝了VeraPort就會自動下載偽裝過的惡意軟體，Lazarus先駭入某些使用WIZVERA VeraPort的合法網站後，再將要下載的軟體置換成惡意binary，藉由VeraPort途徑下載到網站訪客的電腦。最後下載到用戶電腦的是一個遠端木馬程式（RAT）
資安業者Check Point揭露鎖定美國製造業而來攻擊行動ZipLine，駭客藉由企業網站的「聯絡我們」表單建立聯繫管道，由受害企業寄送電子郵件回覆，進而建立信任關係，待時機成熟，再寄送ZIP檔案觸發感染鏈[^4]
趨勢科技於今年6月發現鎖定臺灣用戶的軟體供應鏈攻擊，駭客鎖定已終止開發的搜狗注音輸入法（Sogou Zhuyin IME），挾持軟體更新伺服器及網域，用來作為散布多種惡意程式的管道，並竄改維基百科引誘使用者下載、安裝[^2]

針對延燒超過半個月的Salesloft Drift供應鏈攻擊事故，週末Salesloft公布最新調查結果，指出這起事故最初發生的原因，在於駭客入侵了他們的GitHub儲存庫，導致後續能竊得用戶的OAuth憑證[^3]

Fortinet揭露名為Gayfemboy的惡意程式，利用路由器多項漏洞發動全球攻擊，建立殭屍網路與DDoS基礎設施。[^5]


## 變種

### AI 規則檔案
這種攻擊手法與鎖定特定資安漏洞的程式碼注入有所不同，Rules File Backdoor將AI的「規則檔案」變成攻擊媒介，而有可能使得受到危害的軟體影響終端使用者，造成重大的資安風險。[^13]

### 供應鏈+社交[^11]
供應鏈+社交[^6]

---

Great question! Both **cloud services** and **web apps** definitely fit in this broader discussion because they’re major players in the modern software and content delivery ecosystem, and they bring their own layers of trust and potential attack surfaces.

Here’s where and how you can position them:

---

### Where do *Cloud Services* and *Web Apps* fit?

| Category           | Role in the Trust/Supply Chain Model                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Cloud Services** | They are **trusted intermediaries and platforms** that host, process, and deliver software, data, and services. This makes them part of the **service/cloud supply chain** layer, where attacks can happen if the cloud provider or its components are compromised. For example: a compromised cloud API injecting malicious code, or a misconfigured cloud service exposing a pipeline to tampering.    |
| **Web Apps**       | They are **endpoints and delivery targets** but also often **integrate third-party dependencies** (analytics, widgets, ads) and rely on **cloud platforms** to serve content. They straddle the boundary between origin content and delivery, so vulnerabilities in web apps or injected content through them can be both **source-level compromises** and **vectors for content injection** downstream. |

---


TODO: DISCARD?
### How to mention them in your narrative

* When discussing **trusted relationships**, highlight that cloud providers **extend trust boundaries**—organizations delegate parts of their infrastructure and data to them, creating new supply-chain links and risks.

* When discussing **supply-chain attacks**, mention attacks targeting cloud platforms (e.g., compromised cloud build pipelines, API abuse) as well as web app vulnerabilities that enable injection or compromise.

* When discussing **content injection**, note that web apps often **pull in third-party scripts or content**, which can be injection vectors themselves, or targets for supply-chain attacks.



--- 

## 原罪

## 除非一人包辦所有
就算一人包辦全部軟體開發，但其他
晶片 軟硬體 路由器 電信服務 販售人員

## 正規軟體網站
路過是下載 網站
**水坑攻擊**

## 大組織
會有新的人員、電腦、軟體、網路設備源源不斷湧入
也會有合作夥伴、顧客、子公司與主管機關之前源源不斷的連結 各種複雜性 攻擊面

### 連鎖影響
整條供應戀上
很多負責重要資料的人 不懂很正常 沒有資安知識很正常 處理好自己正值就不簡單了

**保管重要資訊的人**
佛羅里達 警官 accurint 社會安全保險號碼 出生日期 居家住址 駕照號碼
網路供應商 T mobile 員工告訴一切
lack of cybersecurity knowledge can turn human error into the biggest vulnerability, even if the organization has strong technical defenses.

[^6]: https://www.ithome.com.tw/news/170341
[^1]: https://www.ithome.com.tw/news/141202
[^2]: https://www.ithome.com.tw/news/170928
[^3]: https://www.ithome.com.tw/news/171054
[^4]: https://www.ithome.com.tw/news/170950
[^5]: https://netmag.tw/2025/08/27/mirai-variant-hijacks-router-networks
[^6]: https://www.ithome.com.tw/news/170620
[^7]: https://www.ithome.com.tw/news/171071
[^8]: https://www.ithome.com.tw/news/171137
[^9]: https://www.ithome.com.tw/news/171051
[^10]: https://www.ithome.com.tw/news/170928
[^11]: https://www.ithome.com.tw/news/168944
[^12]: https://www.ithome.com.tw/news/168294
[^13]: https://www.ithome.com.tw/news/168098
[^14]: https://www.ithome.com.tw/news/167851
[^15]: https://www.ithome.com.tw/news/167247